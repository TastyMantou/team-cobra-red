<!doctype html>
<html xmlns:v-bind="http://www.w3.org/1999/xhtml" xmlns:v-on="http://www.w3.org/1999/xhtml">
    <head>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
        <script src="https://cdn.jsdelivr.net/vue/latest/vue.js"></script>
        <style type="text/css">
            .todo-list {
                display: flex;
                padding: 0;
                margin: 0;
                justify-content: center;
                flex-direction: column;
            }

            .todo-list__title {
                text-decoration: underline;
            }

            .todo-list__actions {
                display: flex;
                justify-content: space-between;
                color: #E4E4E4;
            }

            .todo-list__action {
                width: 100%;
                padding: 5px;
            }

            .todo-list__action--add {
                background-color: #006600;
                text-align: center;
            }

            .todo-list__action--save {
                background-color: #000066;
                text-align: right;
            }

            .todo-list__action--cancel {
                background-color: #943724;
            }

            .todo {
                display: flex;
                justify-content: space-between;
                list-style: none;
                padding: 5px;
                background-color: teal;
            }

            .todo--active {
                background-color: #3CB3AE;
            }

            .todo__edit-options {
                display: none;
            }

            .todo__edit-options--active {
                display: inline;
            }
        </style>
    </head>
    <body>
        <div class="container-fluid">
            <div class="row">
                <div class="col-xs-6 col-xs-offset-3">
                    <div class="text-center">
                        <h2>Local</h2>
                        <a href="/profile" class="btn btn-default btn-lg">Profile</a>
                        <a href="/logout" class="btn btn-default btn-lg">Logout</a>
                    </div>
                    <div id="mount">
                        <h2 class="todo-list__title"><u>Todo List</u></h2>
                        <ul class="todo-list">
                            <li v-bind:class="['todo', {'todo--active': todo.selected}]" v-for="todo in todos" v-on:click.self="toggleTodo(todo)">{{todo.description}}
                                <div v-bind:class="['todo__edit-options', {'todo__edit-options--active': todo.selected}]">
                                    <select>
                                        <option v-for="option in severityOptions" v-bind:selected="option===todo.severity">{{option}}</option>
                                    </select>
                                    <i class="ion-trash-b" v-on:click.self="deleteTodo(todo)"></i>
                                </div>
                            </li>
                        </ul>
                        <div class="todo-list__actions">
                            <div v-if="itemSelected" class="todo-list__action todo-list__action--cancel"><i class="ion ion-android-cancel"></i> Cancel</div>
                            <div v-if="itemSelected" class="todo-list__action todo-list__action--save"><i class="ion ion-checkmark"></i> Save</div>
                            <div v-if="!itemSelected" class="todo-list__action todo-list__action--add"><i class="ion ion-plus"></i> Add New Todo</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            new Vue({
                el:       '#mount',
                data:     {
                    todos:           [
                        {
                            description: 'todo1', severity: 'magic', selected: false
                        },
                        {
                            description: 'todo2', severity: 'low', selected: false
                        },
                        {
                            description: 'todo3', severity: 'low', selected: false
                        },
                        {
                            description: 'todo4', severity: 'high', selected: false
                        },
                        {
                            description: 'todo5', severity: 'low', selected: false
                        },
                        {
                            description: 'todo6', severity: 'magic', selected: false
                        },
                        {
                            description: 'todo7', severity: 'low', selected: false
                        }
                    ],
                    severityOptions: [
                        'low',
                        'high',
                        'magic'
                    ]
                },
                methods:  {
                    toggleTodo: function (todo) {
                        this.todos = this.todos.map((item) => Object.assign({}, item, {
                                    selected: item === todo ? !item.selected : false
                                })
                        );
                    },
                    deleteTodo: function (todo) {
                        return this.todos = this.todos.filter((item) => todo !== item);
                    }
                },
                computed: {
                    itemSelected: function () {
                        return this.todos.filter((todo) => todo.selected).length > 0;
                    }
                }
            })
        </script>
    </body>
</html>
